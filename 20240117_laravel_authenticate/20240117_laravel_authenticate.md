# LaravelでSPA認証を実装する

## 概要

LaravelでのSPA認証の実装方法の覚書。
使用技術は以下の通り。

- 手動による認証+SanctumによるSPA認証
- セッション+クッキー認証

## 環境

- Laravelのバージョン(9.x)
- Sanctumのバージョン
- Vue.jsのバージョン
- PHPのバージョン

## 参照ドキュメント

- Laravel 9.x Laravel Sanctum
  - https://readouble.com/laravel/9.x/ja/sanctum.html
 
## 認証の流れ

1. ログイン
2. APIを認証で保護する

CSRFトークンについての補足<br>
ログインからフロント側で実装する場合はCSRFトークンの初期化が必要だが、
本記事の手順では最初のSSRによるログイン画面取得で`XSRF-TOKEN`が取得できており、
その後はaxiosが自動でリクエストに付与してくれるため特にこのあたりは設定不要。
ログインからフロントで実行する場合はCSRFトークンの初期化が必要になる。

## 構成

今回はログイン画面はSSRで実装しログイン後はSPAとなる構成としている。

[[画像]]

## 実装手順

1. ログインの実装
  1. ログイン画面はSSRで実装する
2. ログアウトの実装
3. ルートを認証で保護する
4. フロントでログイン/ログアウトの実装
  1. ログインはSSR
  2. ログアウトはAPI
  3. Sanctumの準備







